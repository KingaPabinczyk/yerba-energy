<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Yerba-Energy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
    body {
        background: #f8fbff;
    }
    .navbar {
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .navbar-brand {
        font-weight: bold;
        font-size: 1.8rem; /* większa czcionka logo/nazwy */
        display: flex;
        align-items: center; /* wyśrodkowanie pionowe */
    }
    .navbar-brand img {
        margin-right: 10px;
    }
    .nav-link {
        font-size: 1.1rem; /* większa czcionka linków */
        display: flex;
        align-items: center; /* wyśrodkowanie pionowe */
        transition: color 0.2s ease-in-out;
    }
    .nav-link:hover {
        color: #ffc107 !important;
    }
    .c-main {
        margin-top: 30px;
    }
    .alert {
        border-radius: 12px;
    }
    footer {
        margin-top: 50px;
        padding-top: 30px;
        padding-bottom: 15px;
        background: #212529;
        color: #bbb;
        text-align: center;
        border-top: 1px solid #444;
    }

    .cart-table {
    table-layout: fixed;   /* kolumny mają stały rozkład */
    width: 100%;
    text-align: center;
    white-space: normal; /* zawijaj */
    word-wrap: break-word;
    }
    .card-title:hover {
  color: #198754; /* zielony przy hoverze */
    }

    .input-group .btn {
      min-width: 40px;
    }

    .input-group-text {
      min-width: 40px;
      text-align: center;
    }
    .btn-group .btn {
      min-width: 45px;
      border-radius: 20px;
    }

    .btn-group .btn-light {
      background-color: #f8f9fa; /* lekko szare tło jak przycisk */
      border: 1px solid #dee2e6;
    }

    .formularz {
      margin-bottom: 30px;
    }
    .product-card {
      transition: box-shadow 0.2s ease;
      border-radius: 1rem;
    }

    .product-card:hover {
      box-shadow: 0 6px 16px rgba(0,0,0,0.12);
    }

    .product-card img {
      border-top-left-radius: 1rem;
      border-top-right-radius: 1rem;
    }

    .object-fit-cover {
      object-fit: cover;
    }

    /* Wymusza, żeby nazwa była zawsze min. na 2 linie,
      więc cena w każdej karcie ląduje na tej samej wysokości */
    .card-title {
      min-height: 3em; /* 2 linie tekstu */
      display: flex;
      align-items: flex-start;
      justify-content: center;
      text-align: center;
    }
    .margin-b{
      margin-bottom: 50px;
    }

    .cart-add{
      max-width: 300px;
    }

</style>

</head>
<body class="d-flex flex-column min-vh-100">


<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container"> <!-- zamiast container-fluid -->

    <!-- Lewa strona -->
    <a class="navbar-brand" href="{{ url_for('main.index') }}">
      <img src="{{ url_for('static', filename='logo.png') }}" alt="logo" width="60" height="60">
      Yerba Energy
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain" aria-controls="navbarMain" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-between" id="navbarMain">

      <!-- Admin ma dodatkowe opcje po lewej -->
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        {% if session.get("role") == "admin" %}
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('main.add_product') }}">
              ➕ Dodaj produkt
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('main.users') }}">
              👥 Użytkownicy
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('main.orders') }}">
              📦 Zamówienia
            </a>
          </li>
        {% endif %}
      </ul>


      <!-- Prawa strona -->
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        {% if not session.get("username") %}
          <!-- Niezalogowany -->
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('main.login') }}">🔑 Zaloguj</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('main.register') }}">📝 Zarejestruj</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('main.cart') }}">
                🛒 Koszyk 
                
                {% if session.get("cart") %}
                <span style="margin-left:5px" class="badge bg-warning text-dark">
                    {{ session["cart"].values()|sum }}
                </span>
                {% endif %}
            </a>
          </li>

        {% elif session.get("role") == "admin" %}
          <!-- Admin -->
          <li class="nav-item">
            <a class="nav-link">👑 Witaj, {{ session['username'] }}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-danger" href="{{ url_for('main.logout') }}">🚪 Wyloguj</a>
          </li>

        {% else %}
          <!-- Użytkownik zwykły -->
          <li class="nav-item">
            <a class="nav-link">👋 Witaj, {{ session['username'] }}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link text-danger" href="{{ url_for('main.logout') }}">🚪 Wyloguj</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ url_for('main.cart') }}">
                🛒 Koszyk 
                {% if session.get("cart") %}
                <span class="badge bg-warning text-dark ms-2">
                    {{ session["cart"].values()|sum }}
                </span>
                {% endif %}
            </a>
          </li>
        {% endif %}
      </ul>
    </div>
  </div>
</nav>


<div class="container c-main">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} shadow-sm">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
</div>

<footer class="mt-auto">
  <p>© 2025 Yerba Energy • KP</p>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
